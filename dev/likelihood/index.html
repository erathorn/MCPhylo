<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Likelihood · MCPhylo.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MCPhylo.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Index</a></li><li class="is-active"><a class="tocitem" href>Likelihood</a><ul class="internal"><li><a class="tocitem" href="#Likelihood-Calculator-functionality"><span>Likelihood Calculator functionality</span></a></li><li><a class="tocitem" href="#Prior"><span>Prior</span></a></li><li><a class="tocitem" href="#Gamma-Rates"><span>Gamma Rates</span></a></li><li><a class="tocitem" href="#Substitution-Models"><span>Substitution Models</span></a></li></ul></li><li><a class="tocitem" href="../distributions/">Distributions</a></li><li><a class="tocitem" href="../model/">Model</a></li><li><a class="tocitem" href="../output/">Output</a></li><li><a class="tocitem" href="../samplers/">Samplers</a></li><li><a class="tocitem" href="../utils/">Utils</a></li><li><a class="tocitem" href="../links/">Links</a></li><li><a class="tocitem" href="../developers/">For Developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Likelihood</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Likelihood</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/erathorn/MCPhylo.jl/blob/master/docs/src/likelihood.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Likelihood"><a class="docs-heading-anchor" href="#Likelihood">Likelihood</a><a id="Likelihood-1"></a><a class="docs-heading-anchor-permalink" href="#Likelihood" title="Permalink"></a></h1><p>There are several prior distributions for tree structures implemented in this package. Also there is a function which calculates the likelihood of a tree given a model using Felsensteins algorithm.</p><h2 id="Likelihood-Calculator-functionality"><a class="docs-heading-anchor" href="#Likelihood-Calculator-functionality">Likelihood Calculator functionality</a><a id="Likelihood-Calculator-functionality-1"></a><a class="docs-heading-anchor-permalink" href="#Likelihood-Calculator-functionality" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.FelsensteinFunction_wg-Union{Tuple{N}, Tuple{Vector{N}, Array{Float64, N} where N, Float64, Matrix{T} where T, Vector{T} where T, Matrix{T} where T, Float64, Array{Float64, 3}, Function}} where N&lt;:GeneralNode" href="#MCPhylo.FelsensteinFunction_wg-Union{Tuple{N}, Tuple{Vector{N}, Array{Float64, N} where N, Float64, Matrix{T} where T, Vector{T} where T, Matrix{T} where T, Float64, Array{Float64, 3}, Function}} where N&lt;:GeneralNode"><code>MCPhylo.FelsensteinFunction_wg</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">FelsensteinFunction(tree_postorder::Vector{N}, pi_::Array{Float64}, rates::Array{Float64},
                     U::Array{Float64,2}, D::Array{Float64}, Uinv::Array{Float64,2},
                     data::Array{Float64,4}, c_grad::Bool = true) where {N&lt;:GeneralNode}</code></pre><p>This function calculates the log-likelihood of an evolutiuonary model using the Felsensteins pruning algorithm. If <code>c_grad</code> equals <code>true</code> (default) the analytic gradient regarding the branch lengths of the tree gets computed as well.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/Likelihood/LikelihoodCalculator_Node.jl#L2-L10">source</a></section></article><h2 id="Prior"><a class="docs-heading-anchor" href="#Prior">Prior</a><a id="Prior-1"></a><a class="docs-heading-anchor-permalink" href="#Prior" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.TreeDistribution" href="#MCPhylo.TreeDistribution"><code>MCPhylo.TreeDistribution</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TreeDistribution(length_distr::LengthDistribution, topology_distr::TopologyDistribution)</code></pre><p>Wrapper struct for the TreeDistribution. Contains a length distribution and a topology distribution. Can be constructed with no arguments, one of the distributions, or both of  them. Fallbacks are UniformBranchLength for the length distribution &amp; and UniformTopology for the topology distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/distributions/TreeDistribution.jl#L80-L87">source</a></section></article><h3 id="Branch-length-distributions"><a class="docs-heading-anchor" href="#Branch-length-distributions">Branch length distributions</a><a id="Branch-length-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Branch-length-distributions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.CompoundDirichlet" href="#MCPhylo.CompoundDirichlet"><code>MCPhylo.CompoundDirichlet</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CompoundDirichlet(alpha::Float64, a::Float64, beta::Float64, c::Float64, nterm::Float64)</code></pre><p>This structure implememts the CompoundDirichlet distribution described in Zhang, Rannala and Yang 2012. (DOI:10.1093/sysbio/sys030)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/distributions/TreeDistribution.jl#L19-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.exponentialBL" href="#MCPhylo.exponentialBL"><code>MCPhylo.exponentialBL</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">exponentialBL(scale::Float64) &lt;: ContinuousUnivariateDistribution</code></pre><p>This structure implememts an exponential prior on the branch lengths of a tree.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/distributions/TreeDistribution.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.UniformBranchLength" href="#MCPhylo.UniformBranchLength"><code>MCPhylo.UniformBranchLength</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">UniformBranchLength()</code></pre><p>Fallback struct that is used when no length distribution is given </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/distributions/TreeDistribution.jl#L39-L44">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.BirthDeath" href="#MCPhylo.BirthDeath"><code>MCPhylo.BirthDeath</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Strict Molecular Clock - BirthDeath Implemented following Yang &amp; Rannala 1997 doi.org/10.1093/oxfordjournals.molbev.a025811</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/Likelihood/Prior.jl#L106-L110">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.BirthDeathSimplified" href="#MCPhylo.BirthDeathSimplified"><code>MCPhylo.BirthDeathSimplified</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Strict Molecular Clock - Simplified Birth Death Implemented folloing Yang &amp; Rannala 1996 doi.org/10.1007/BF02338839</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/Likelihood/Prior.jl#L136-L140">source</a></section></article><h3 id="Topology-distributions"><a class="docs-heading-anchor" href="#Topology-distributions">Topology distributions</a><a id="Topology-distributions-1"></a><a class="docs-heading-anchor-permalink" href="#Topology-distributions" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.UniformConstrained" href="#MCPhylo.UniformConstrained"><code>MCPhylo.UniformConstrained</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">UniformConstrained(
    constraint_dict::Dict{Symbol, 
                          Union{Vector{Vector{S}}, Vector{Tuple{Vector{S}, Vector{S}}}}
                          } where S &lt;: AbstractString)</code></pre><p>Wrapper struct for the topology distribution. Contains a dictionary with constraints. Empty constructor results in an empty dictionary as a fallback.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/distributions/TreeDistribution.jl#L51-L59">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.UniformTopology" href="#MCPhylo.UniformTopology"><code>MCPhylo.UniformTopology</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">UniformTopology()</code></pre><p>Fallback struct that is used when no topology distribution is given.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/distributions/TreeDistribution.jl#L69-L74">source</a></section></article><h2 id="Gamma-Rates"><a class="docs-heading-anchor" href="#Gamma-Rates">Gamma Rates</a><a id="Gamma-Rates-1"></a><a class="docs-heading-anchor-permalink" href="#Gamma-Rates" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.discrete_gamma_rates" href="#MCPhylo.discrete_gamma_rates"><code>MCPhylo.discrete_gamma_rates</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function discrete_gamma_rates(α::T, β::S,k::Int64; method::Symbol=:mean, sig::Int64=1)::Array{Float64} where {T&lt;:Real, S&lt;:Real}</code></pre><p>This function calculates the rates of the discretized gamma distribution. It returns a vector of either the mean or the median weights in each category, such that each category is of equal proportion.</p><p>See: Yang, 1994, Maximum likelihood phylogenetic estimation from DNA sequences with variable rates over sites: Approximate methods. (https://doi.org/10.1007/BF00160154)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/Likelihood/Rates.jl#L1-L10">source</a></section></article><h2 id="Substitution-Models"><a class="docs-heading-anchor" href="#Substitution-Models">Substitution Models</a><a id="Substitution-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Substitution-Models" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.JC" href="#MCPhylo.JC"><code>MCPhylo.JC</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">JC(base_freq::Vector{Float64},
    SubstitutionRates::Vector{Float64})::Tuple{Array{Float64,2}, Array{Float64,1}, Array{Float64,2}}</code></pre><p>Calculate the eigenvalue decomposition of the Q matrix of the Jukes-Cantor model. The <code>SubstitutionRates</code> are ignored, and just for call stability.</p><p>The function returns the Eigenvectors, Eigenvalues and inverse of eigenvectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/Likelihood/SubstitutionModels.jl#L27-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.Restriction" href="#MCPhylo.Restriction"><code>MCPhylo.Restriction</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Restriction(base_freq::Vector{Float64},
            SubstitutionRates::Vector{Float64})::Tuple{Array{Float64,2}, Array{Float64,1}, Array{Float64,2}}</code></pre><p>Calculate the eigenvalue decomposition of the Q matrix of the restriction site model. The <code>SubstitutionRates</code> are ignored, and just for call stability.</p><p>The function returns the Eigenvectors, Eigenvalues, inverse of eigenvectors and     the scale factor for expected number changes per site</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/Likelihood/SubstitutionModels.jl#L5-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.freeK" href="#MCPhylo.freeK"><code>MCPhylo.freeK</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function freeK(base_freq::Vector{Float64},SubstitutionRates::AbstractArray)::Tuple{Array{N,2}, Array{N,1}, Array{N,2}, M} where {N &lt;: Number, M &lt;: Number}</code></pre><p>FreeK model of substitution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/Likelihood/SubstitutionModels.jl#L71-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MCPhylo.GTR" href="#MCPhylo.GTR"><code>MCPhylo.GTR</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">GTR(base_freq::Vector{Float64},
    SubstitutionRates::Vector{Float64})::Tuple{Array{Float64,2}, Array{Float64,1}, Array{Float64,2}}</code></pre><p>Calculate the eigenvalue decomposition of the Q matrix of the General Time Reversible model.</p><p>The function returns the Eigenvectors, Eigenvalues and inverse of eigenvectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/erathorn/MCPhylo.jl/blob/b260a3a0505def0916fc1e07ac8b70fa3142ffef/src/Likelihood/SubstitutionModels.jl#L50-L58">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Index</a><a class="docs-footer-nextpage" href="../distributions/">Distributions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.17 on <span class="colophon-date" title="Tuesday 17 May 2022 11:18">Tuesday 17 May 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
